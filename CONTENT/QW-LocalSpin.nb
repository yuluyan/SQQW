(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12516,        356]
NotebookOptionsPosition[     12115,        339]
NotebookOutlinePosition[     12459,        354]
CellTagsIndexPosition[     12416,        351]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<SQQW.wl\>\""}], 
  "]"}], "\n", 
 RowBox[{
  RowBox[{"SQQWInitialize", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.659310245543229*^9, 3.6593102582434206`*^9}, {
   3.659310324555334*^9, 3.6593103838823137`*^9}, {3.6593109461716614`*^9, 
   3.6593109463232737`*^9}, {3.659317646906698*^9, 3.6593176705306463`*^9}, 
   3.6593178160805135`*^9, {3.6593179549727583`*^9, 3.6593179575810256`*^9}, {
   3.659318226377237*^9, 3.659318228737175*^9}, {3.6593332702869377`*^9, 
   3.659333270514102*^9}, {3.659336497667048*^9, 3.6593365140449*^9}, {
   3.6593439199909363`*^9, 3.659343920630667*^9}, {3.6593588554777203`*^9, 
   3.6593588573098764`*^9}, {3.659359075308563*^9, 3.6593590883231544`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gridSizeL", "=", "10"}], ";", 
  RowBox[{"particalType", "=", "\"\<Boson\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Initial", "=", 
   RowBox[{"SQInitial", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"0.5", 
      RowBox[{"InitialTerm", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"1", "/", "2"}], ",", "1", ",", 
         RowBox[{"1", "/", "2"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
     "+", 
     RowBox[{"0.5", 
      RowBox[{"InitialTerm", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"1", "/", "2"}], ",", "1", ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{"0.5", 
      RowBox[{"InitialTerm", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], ",", "1", ",", 
         RowBox[{"1", "/", "2"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
     "+", 
     RowBox[{"0.5", 
      RowBox[{"InitialTerm", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], ",", "1", ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H2", "=", 
   RowBox[{"SQHamiltonian", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], " ", 
      RowBox[{"HInfiniteSum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox[
           SuperscriptBox["a", "\[Dagger]"], 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"l", "+", "1"}], ",", "s"}], "}"}]], "**", 
          SubscriptBox["a", 
           RowBox[{"{", 
            RowBox[{"l", ",", "s"}], "}"}]]}], "+", 
         RowBox[{
          SubscriptBox[
           SuperscriptBox["a", "\[Dagger]"], 
           RowBox[{"{", 
            RowBox[{"l", ",", "s"}], "}"}]], "**", 
          SubscriptBox["a", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"l", "+", "1"}], ",", "s"}], "}"}]]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "s"}], "}"}]}], "]"}]}], "+", 
     RowBox[{"50", 
      RowBox[{"HInfiniteSum", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["n", 
          RowBox[{"{", 
           RowBox[{"l", ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]], "**", 
         SubscriptBox["n", 
          RowBox[{"{", 
           RowBox[{"l", ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], "}"}]]}], ",", 
        RowBox[{"{", "l", "}"}]}], "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.6594023079670796`*^9, {3.659404878274123*^9, 3.659404948954323*^9}, {
   3.6594050320581913`*^9, 3.659405037967924*^9}, {3.6594071498002253`*^9, 
   3.659407161361761*^9}, {3.659407214272726*^9, 3.659407253430898*^9}, 
   3.6594074450928507`*^9, {3.6595064963270893`*^9, 3.659506497364275*^9}, 
   3.65950656817927*^9, {3.659506633259477*^9, 3.6595066444265013`*^9}, {
   3.659506743321577*^9, 3.659506743920847*^9}, 3.6595074941153603`*^9, 
   3.6595075268820915`*^9, {3.6595075871376314`*^9, 3.6595076097354345`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"fe", ",", "fd"}], "}"}], ",", "H2Base", ",", 
     "H2WaveFunction"}], "}"}], "=", 
   RowBox[{"SQHamiltonialEvolve", "[", 
    RowBox[{"H2", ",", "particalType", ",", "Initial", ",", 
     RowBox[{
      SubscriptBox[
       SuperscriptBox["a", "\[Dagger]"], 
       RowBox[{"{", 
        RowBox[{"l1", ",", "s1"}], "}"}]], "**", 
      SubscriptBox[
       SuperscriptBox["a", "\[Dagger]"], 
       RowBox[{"{", 
        RowBox[{"l2", ",", "s2"}], "}"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"l1", ",", "s1", ",", "l2", ",", "s2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"l1", ",", 
         RowBox[{"-", "gridSizeL"}], ",", "gridSizeL"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s1", ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], ",", 
         RowBox[{"1", "/", "2"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l2", ",", 
         RowBox[{"l1", "+", "0"}], ",", "gridSizeL"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s2", ",", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], ",", 
         RowBox[{"1", "/", "2"}], ",", "1"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6593996744599805`*^9, 3.659399741611658*^9}, {
   3.659400807248766*^9, 3.6594008077283754`*^9}, 3.6594014900489836`*^9, {
   3.659404174235115*^9, 3.659404195890058*^9}, {3.6594042746766334`*^9, 
   3.6594043053533897`*^9}, {3.6594044502317095`*^9, 3.659404473126503*^9}, {
   3.659404861331517*^9, 3.6594048629618945`*^9}, {3.659404952919103*^9, 
   3.65940499948892*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"H2CorelationHalf", "[", 
    RowBox[{"t_", ",", 
     RowBox[{"{", 
      RowBox[{"spin1_", ",", "spin2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "&"}], "/@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"Rule", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "+", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"gridSizeL", "+", "1"}], ",", " ", "0", ",", 
                    RowBox[{"gridSizeL", "+", "1"}], ",", "0"}], "}"}]}], 
                 "&"}], ",", "H2Base"}], "]"}], ",", 
              RowBox[{"H2WaveFunction", "[", "t", "]"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], "\[Equal]", "spin1"}], 
             "&&", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "4"}], "]"}], "]"}], "\[Equal]", 
              "spin2"}]}], "&"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "gridSizeL"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"2", "gridSizeL"}], "+", "1"}]}], "}"}]}], "]"}], "]"}], 
     "]"}], "^", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H2Corelation", "[", 
    RowBox[{"t_", ",", 
     RowBox[{"{", 
      RowBox[{"spin1_", ",", "spin2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "+", 
       RowBox[{"Transpose", "[", "#", "]"}]}], ")"}], "&"}], "[", 
    RowBox[{"H2CorelationHalf", "[", 
     RowBox[{"t", ",", 
      RowBox[{"{", 
       RowBox[{"spin1", ",", "spin2"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6594049878166227`*^9, 3.659404988104641*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Grid", "@", 
    RowBox[{"Map", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"spin", ",", "\[IndentingNewLine]", 
        RowBox[{"MatrixPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Chop", "@", 
           RowBox[{"H2Corelation", "[", 
            RowBox[{"t", ",", "spin"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"DataReversed", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"True", ",", "False"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ColorFunction", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Hue", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "#"}], ")"}], "^", "0.23"}], "*", "0.83"}],
               "]"}], "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "+", "gridSizeL", "+", "1"}], ",", "i"}], "}"}],
                ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"-", "gridSizeL"}], ",", "gridSizeL", ",", "5"}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i", "+", "gridSizeL", "+", "1"}], ",", "i"}], "}"}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"-", "gridSizeL"}], ",", "gridSizeL", ",", "5"}], 
                "}"}]}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}], ",", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6595072624510765`*^9, 3.659507299115563*^9}, {
  3.6595073491706085`*^9, 3.6595073745698814`*^9}, {3.659507415466976*^9, 
  3.659507470369013*^9}}]
},
WindowSize->{1858, 1037},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 29, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 898, 17, 72, "Input"],
Cell[1459, 39, 3252, 91, 174, "Input"],
Cell[4714, 132, 1700, 45, 33, "Input"],
Cell[6417, 179, 2504, 73, 92, "Input"],
Cell[8924, 254, 3187, 83, 312, "Input"]
}
]
*)

(* End of internal cache information *)
